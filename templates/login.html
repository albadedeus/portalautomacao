<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login | Portal de Automa&ccedil;&otilde;es</title>
  <link rel="icon" type="image/png" href="/static/logo-hexa.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    @font-face {
      font-family: 'TOTVS-Bold';
      src: url('/assets/fonts/TOTVS-Bold.ttf') format('truetype');
      font-weight: 700;
      font-style: normal;
      font-display: swap;
    }

    :root {
      --font-sans: 'TOTVS-Bold', sans-serif;
      --color-blue-light: #00DBFF;
      --color-blue-dark: #002233;
      --color-purple: #A44DFF;
      --color-green: #00FFD4;
      --color-lime: #D9FF65;
      --color-orange: #FF8900;
      --color-pink: #FF009E;
      --totvs-white: #ffffff;
      --transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: var(--font-sans);
      background: var(--color-blue-dark);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      position: relative;
      overflow: hidden;
    }

    .bg-glow-1,
    .bg-glow-2 {
      position: absolute;
      border-radius: 50%;
      pointer-events: none;
      z-index: 0;
    }

    .bg-glow-1 {
      width: 520px;
      height: 520px;
      background: var(--color-blue-light);
      filter: blur(170px);
      opacity: 0.09;
      top: -180px;
      right: -220px;
    }

    .bg-glow-2 {
      width: 420px;
      height: 420px;
      background: var(--color-purple);
      filter: blur(180px);
      opacity: 0.1;
      bottom: -170px;
      left: -170px;
    }

    .login-card {
      width: 100%;
      max-width: 620px;
      border-radius: 24px;
      background: linear-gradient(180deg, rgba(0,34,51,0.98), rgba(0,34,51,0.95));
      border: 1px solid rgba(0, 219, 255, 0.15);
      box-shadow: 0 30px 70px rgba(0,0,0,0.55);
      padding: 2rem 1.8rem 1.8rem;
      position: relative;
      z-index: 1;
    }

    .login-header { margin-bottom: 2rem; }

    .brand {
      display: flex;
      justify-content: center;
      margin-bottom: 1.6rem;
    }

    .brand img {
      max-width: 100%;
      height: 56px;
      object-fit: contain;
    }

    .brand-separator {
      height: 1px;
      width: 100%;
      background: rgba(0, 219, 255, 0.2);
      margin-bottom: 2rem;
    }

    .login-title {
      color: var(--totvs-white);
      text-align: center;
      font-size: 1.55rem;
      font-weight: 800;
      margin-bottom: 0.55rem;
    }

    .login-subtitle {
      color: rgba(255,255,255,0.88);
      text-align: center;
      font-size: 1rem;
    }

    .message {
      border-radius: 12px;
      padding: 1rem 1.2rem;
      font-size: 0.95rem;
      display: none;
      align-items: center;
      gap: 0.7rem;
      margin-bottom: 1.4rem;
    }

    .message.show { display: flex; }

    .message.error {
      background: rgba(255,0,158,0.08);
      border: 1px solid rgba(255,0,158,0.2);
      color: var(--color-pink);
    }

    .message.success {
      background: rgba(0,255,212,0.08);
      border: 1px solid rgba(0,255,212,0.2);
      color: var(--color-green);
    }

    .login-form {
      display: flex;
      flex-direction: column;
      gap: 1.3rem;
    }

    .form-group label {
      display: block;
      color: var(--totvs-white);
      font-size: 1rem;
      font-weight: 700;
      margin-bottom: 0.6rem;
    }

    .input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .input-icon {
      position: absolute;
      left: 1rem;
      color: var(--totvs-white);
      font-size: 1rem;
      opacity: 0.95;
      pointer-events: none;
    }

    .form-group input {
      width: 100%;
      height: 52px;
      border-radius: 12px;
      border: 1px solid rgba(0, 219, 255, 0.22);
      background: rgba(0, 34, 51, 0.75);
      color: var(--totvs-white);
      font-family: inherit;
      font-size: 0.95rem;
      padding: 0 1rem 0 3rem;
      transition: var(--transition);
    }

    .form-group input::placeholder { color: rgba(255,255,255,0.58); }

    .form-group input:focus {
      outline: none;
      border-color: var(--color-blue-light);
      box-shadow: 0 0 0 3px rgba(0, 219, 255, 0.18);
      background: rgba(0, 34, 51, 0.9);
    }

    .toggle-password {
      position: absolute;
      right: 1rem;
      background: none;
      border: none;
      color: rgba(255,255,255,0.72);
      cursor: pointer;
      padding: 0.25rem;
      transition: var(--transition);
    }

    .toggle-password:hover { color: var(--color-blue-light); }

    .btn-login {
      margin-top: 0.5rem;
      width: 100%;
      height: 52px;
      border-radius: 12px;
      border: none;
      background: var(--color-blue-light);
      color: var(--color-blue-dark);
      font-family: inherit;
      font-size: 1rem;
      font-weight: 800;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.65rem;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 14px 30px rgba(0, 219, 255, 0.25);
    }

    .btn-login:hover {
      transform: translateY(-2px);
      box-shadow: 0 18px 34px rgba(0, 219, 255, 0.3);
    }

    .btn-login:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
    }

    .login-footer {
      text-align: center;
      margin-top: 1.6rem;
    }

    .login-footer a {
      color: rgba(255,255,255,0.78);
      text-decoration: none;
      font-size: 1rem;
      font-weight: 600;
    }

    .spinner {
      width: 20px;
      height: 20px;
      border: 2px solid transparent;
      border-top-color: currentColor;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    @media (max-width: 768px) {
      body { padding: 1rem; }
      .login-card { padding: 1.4rem 1rem; border-radius: 16px; }
      .brand img { height: 42px; }
      .brand-separator { margin-bottom: 1.5rem; }
      .login-title { font-size: 1.35rem; }
      .login-subtitle { font-size: 0.9rem; }
      .form-group input { height: 48px; border-radius: 10px; }
      .btn-login { height: 48px; border-radius: 10px; font-size: 0.95rem; }
    }
  </style>
</head>

<body>
  <div class="bg-glow-1"></div>
  <div class="bg-glow-2"></div>

  <div class="login-card">
    <div class="login-header">
      <div class="brand">
        <img src="/assets/img/TOTVS%20Nordeste%20-%20Logo%20-%20Branco.png" alt="TOTVS Nordeste" onerror="this.onerror=null;this.src='/static/logo-totvs-branco.png';">
      </div>
      <div class="brand-separator"></div>
      <div class="login-title">Portal de Automa&ccedil;&otilde;es</div>
      <div class="login-subtitle">Fa&ccedil;a login para acessar</div>
    </div>

    <div class="message" id="messageBox">
      <i class="fas fa-exclamation-circle" id="messageIcon"></i>
      <span id="messageText">Erro</span>
    </div>

    <form class="login-form" id="loginForm" onsubmit="handleLogin(event)">
      <div class="form-group">
        <label for="username">Usu&aacute;rio</label>
        <div class="input-wrapper">
          <i class="fas fa-user input-icon"></i>
          <input type="text" id="username" placeholder="Digite seu usu&aacute;rio" required>
        </div>
      </div>

      <div class="form-group">
        <label for="password">Senha</label>
        <div class="input-wrapper">
          <i class="fas fa-lock input-icon"></i>
          <input type="password" id="password" placeholder="Digite sua senha" required>
          <button type="button" class="toggle-password" onclick="togglePassword()">
            <i class="fas fa-eye" id="toggleIcon"></i>
          </button>
        </div>
      </div>

      <button type="submit" class="btn-login" id="btnLogin">
        <span id="btnText">Entrar</span>
        <i class="fas fa-arrow-right" id="btnIcon"></i>
      </button>
    </form>
  </div>

  <script>
    function togglePassword() {
      const passwordInput = document.getElementById('password');
      const toggleIcon = document.getElementById('toggleIcon');

      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        toggleIcon.classList.remove('fa-eye');
        toggleIcon.classList.add('fa-eye-slash');
      } else {
        passwordInput.type = 'password';
        toggleIcon.classList.remove('fa-eye-slash');
        toggleIcon.classList.add('fa-eye');
      }
    }

    function showMessage(text, type = 'error') {
      const messageBox = document.getElementById('messageBox');
      const messageText = document.getElementById('messageText');
      const messageIcon = document.getElementById('messageIcon');

      messageText.textContent = text;
      messageBox.className = `message show ${type}`;
      messageIcon.className = type === 'error' ? 'fas fa-exclamation-circle' : 'fas fa-check-circle';
    }

    function hideMessage() {
      document.getElementById('messageBox').classList.remove('show');
    }

    async function handleLogin(event) {
      event.preventDefault();

      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value;
      const btnLogin = document.getElementById('btnLogin');
      const btnIcon = document.getElementById('btnIcon');
      const btnText = document.getElementById('btnText');

      if (!username || !password) {
        showMessage('Preencha todos os campos');
        return;
      }

      btnLogin.disabled = true;
      btnIcon.className = 'spinner';
      btnText.textContent = 'Entrando...';
      hideMessage();

      try {
        const response = await fetch('/auth/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username, password })
        });

        const data = await response.json();

        if (data.success) {
          showMessage('Login realizado com sucesso!', 'success');
          setTimeout(() => {
            window.location.href = data.redirect || '/dashboard';
          }, 500);
        } else {
          showMessage(data.error || 'Erro ao fazer login');
          btnLogin.disabled = false;
          btnIcon.className = 'fas fa-arrow-right';
          btnText.textContent = 'Entrar';
        }
      } catch (error) {
        showMessage('Erro de conexao. Tente novamente.');
        btnLogin.disabled = false;
        btnIcon.className = 'fas fa-arrow-right';
        btnText.textContent = 'Entrar';
      }
    }
  </script>
</body>
</html>




